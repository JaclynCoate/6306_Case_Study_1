---
title: '6306 DDS: Case Study 1'
author: "Jaclyn Ann Coate & Huy Hoang Nguyen"
date: "10/7/2019"
output: html_document
---

#Introduction
# a.	The introduction needs to be written as if you are presenting the work to the CEO and CFO of Budweiser (your client) and that they only have had one class in statistics.  If it sounds like a student presentation, that is not acceptable.  You may assume that the CEO and CFO gave you the data and gave you the directive to report any interesting finding that you may uncover through your analysis.

# b.	Briefly explain the purpose of the code. The explanations should appear as a sentence or two before or after the code chunk. Even though you will not be hiding the code chunks (so that I can see the code), you need to assume that the client can’t see them.

# c.	Use R to code answers concerning the seven questions below.

# Below we are prepping our environment with different libraries we will need to complete our analysis. 
```{r}
library(tidyverse)
library(ggthemes)
library(dplyr)
install.packages("highcharter")
library(highcharter)
```


# 1. How many breweries are present in each state?

## Import data Breweries into R.
```{r}
breweries <- read.csv("https://raw.githubusercontent.com/BivinSadler/MDS-6306-Doing-Data-Science-Fall-2019/master/Unit%208%20and%209%20Case%20Study%201/Breweries.csv", header = TRUE)
breweries
nrow(breweries)
summary(breweries)
```

## Breweries bar graphed by state.
```{r}
breweries %>% ggplot(mapping = aes(x=State, fill=State)) +
  geom_bar(sstat = "identity") +
  #theme_excel_new() +
  theme_tufte() +
  theme(legend.position="none") + 
ggtitle("Breweries by State") + ylab("Count") + xlab("State")
```

## ** Breweries geo graphed by state
## ** Create a Geo map of shaded color for the states with the largest count of breweries ** #


# 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  (RMD only, this does not need to be included in the presentation or the deck.)

## Import Beer into data R.
```{r}
beers <- read.csv("https://raw.githubusercontent.com/BivinSadler/MDS-6306-Doing-Data-Science-Fall-2019/master/Unit%208%20and%209%20Case%20Study%201/Beers.csv", header = TRUE)
str(beers)
```

## We obvserve that our key value "Brew_ID" from our breweries data is named "Brewery_id". In order to have these values match and make tables easier to merge we are renaming the column in the beer data set.
```{r}
beers <-  beers %>% dplyr::rename( Brew_ID = Brewery_id)
beers
```

## We observe that the two name columns have the same name in our Brewery and Beer data sets. So we are giving them unique identifiers.
```{r}
breweries <- breweries %>% dplyr::rename(Name_Brew = Name)  
beers <- beers %>% dplyr::rename(Name_Beer = Name)

breweries
beers
```

## We complete a full_join of both data frames to loose minimum amount of data for review.
```{r}
brew.beer <- full_join(breweries, beers, by = "Brew_ID")
str(brew.beer)
brew.beer
```

## We print first 6 and last 6 rows of merged data set below.
```{r}
brew.beer %>% tail(6)
brew.beer %>% head(6)
```




# 3. Address the missing values in each column.

## We review the data nd we see ABV contains 62 NAs and IBU contains 1005 NAs. We are keeping those data frames separate to prevent more data loss.
## **List a data frame of the NA's by category
```{r}
brew.beer %>% summarise_all(funs(sum(is.na(.))))
```




# 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

## Per discussion above we choose to keep the data frames separate to reduce the amount of data lost to NAs
### Jaclyn to discuss with TA on how to incorporate the data as well.
## Graphing Median ABV by State
```{r}
brew.beer.cleanABV <- brew.beer %>% filter(!is.na(ABV))
MedianABV <- brew.beer.cleanABV %>% group_by(State) %>% summarise(medABV = median(c(ABV)))

MedianABV %>% ggplot(aes(fill=State, y=medABV, x=State)) + 
  geom_bar(stat="identity") + 
  theme_excel_new() +
ggtitle("Median ABV by State") + ylab("ABV") + xlab("State")
```

## Graphing Median IBU by State
```{r}
brew.beer.cleanIBU <- brew.beer %>% filter(!is.na(IBU))
MedianIBU <- brew.beer.cleanIBU %>% group_by(State) %>% summarise(medIBU = median(c(IBU)))

MedianIBU %>% ggplot(aes(fill=State, y=medIBU, x=State)) + 
  geom_bar(stat="identity") + 
  theme_excel_new() +
ggtitle("Median IBU by State") + ylab("IBU") + xlab("State")
```




# 5a. Which state has the maximum alcoholic (ABV) beer? 

## Below we have listed the higest median ABV.
```{r}
y_maxABV <- max(MedianABV[,2])
y_maxABV
stateABV_associated <- MedianABV[MedianABV$medABV == y_maxABV, "State"]
stateABV_associated
```
### The State with the highest median ABV is DC and KY at 6.45%.

## Jaclyn's code on this question
## Below we have listed the max ABV.
```{r}
brew.beer
brew.beer[which.max(brew.beer$ABV),]
```
### The state with the highest ABV is Colorado at 12.8%.

# 5b. Which state has the most bitter (IBU) beer?

## Below we have listed the higest median ABV.
```{r}
y_maxIBU <- max(MedianIBU[,2])
y_maxIBU
stateIBU_associated <- MedianIBU[MedianIBU$medIBU == y_maxIBU, "State"]
stateIBU_associated
```
### The state with the highest median IBU is Main at 61.

## Jaclyn's code on this question
## Below we have listed the max IBU.
```{r}
brew.beer
brew.beer[which.max(brew.beer$IBU),]
```
### The sate with the highest IBU is Oregon at 138.




# 6. Comment on the summary statistics and distribution of the ABV variable.
```{r}
summary(MedianABV)
```



# 7a. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? 
## There does seem to be a relationsihp between IBU and ABV. We will further investigate with the below.

# 7b. Draw a scatter plot.
```{r}
brew.beer
brew.beer %>% ggplot(mapping = aes(x=IBU, y=ABV)) +
  geom_point() + 
  geom_smooth(method = 'lm') +
  theme_excel_new() +
ggtitle("Bitterness (IBU) vs. Alcoholic Content (IBV)") + ylab("XXXXX") + xlab("XXXXX")
```
## ** Create a scatter plot of a third variable against the IBU and ABV (e.g. Style of Beer, State) fill with that metric

# 7c. Make your best judgment of a relationship and EXPLAIN your answer.
## Based on the above scatter plot and correlation line we can see a small positive linear relationship. This tells us that as the alcohol content (ABV), in general, so does the bitterness (IBU). This linear correlation means there is a relationship but does not mean that we can provide causation. Therefore, while, these two things do have a positive linear relationship, we cannot clearly state that one high value causes the high value of another.




# 8. Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).  You decide to use KNN clustering to investigate this relationship.  Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand.  
```{r}
```

```{r}
```

```{r}
```

```{r}
```


# 9. Knock their socks off!  Find one other useful inference from the data that you feel Budweiser may be able to find value in.  You must convince them why it is important and back up your conviction with appropriate statistical evidence. 

# ** We use KNN to assign plausible valuse to the beers that are NA. The we regraph our analysis with this added data.** #
# ** Then we use this analysis in order to advise Budweiser on how to release beers that will combat the growing microbrewery market that they are loosing market share in ** #

```{r}
```

```{r}
```

```{r}
```

```{r}
```
